## ì˜í™” ì˜ˆë§¤ ì‹œìŠ¤í…œ

### ìš”êµ¬ì‚¬í•­ ì‚´í´ë³´ê¸°

1. ì˜í™” vs ìƒì˜
    
    
    | êµ¬ë¶„ | ë‚´ìš© | êµ¬ì„± ìš”ì†Œ |
    | --- | --- | --- |
    | ì˜í™”(Movie) | ì˜í™” ìì²´ ì •ë³´, ì œëª©Â·ìƒì˜ì‹œê°„Â·ê¸°ë³¸ ê°€ê²© | ì œëª©, ìƒì˜ ì‹œê°„, ê°€ê²© ì •ë³´ |
    | ìƒì˜(Screening) | íŠ¹ì • ì‹œê°„ëŒ€ì— ì˜í™”ê°€ ìƒì˜ë˜ëŠ” ì‚¬ê±´ | ìƒì˜ ì¼ì. ì‹œê°„, ìˆœë²ˆ |
2. í• ì¸ ì¡°ê±´(Discount Condition) :  ê°€ê²©ì˜ í• ì¸ ì—¬ë¶€ë¥¼ ê²°ì •
    
    
    | ì¡°ê±´ ì¢…ë¥˜ | ê¸°ì¤€ | êµ¬ì„± ìš”ì†Œ |
    | --- | --- | --- |
    | ìˆœì„œ ì¡°ê±´(Sequence) | ìƒì˜ ìˆœë²ˆ | ìˆœë²ˆ |
    | ê¸°ê°„ ì¡°ê±´(Period) | ìƒì˜ ì‹œì‘ ì‹œê°„ | ìš”ì¼, ì‹œì‘ ì‹œê°„, ì¢…ë£Œ ì‹œê°„ |
3. í• ì¸ ì •ì±…(Discount Policy)
    
    
    | ì •ì±… ì¢…ë¥˜ | ì ìš© ë°©ì‹ | ì˜ˆì‹œ |
    | --- | --- | --- |
    | ê¸ˆì•¡ í• ì¸ ì •ì±…(Amount) | ê³ ì • ê¸ˆì•¡ í• ì¸ | 9,000ì› ì˜í™” â†’ 800ì› í• ì¸ â†’ 8,200ì› |
    | ë¹„ìœ¨ í• ì¸ ì •ì±…(Percent) | ì •ê°€ì˜ ì¼ì • ë¹„ìœ¨ í• ì¸ | 9,000ì› ì˜í™” â†’ 10% í• ì¸ â†’ 8,100ì› |
4. í• ì¸ ì ìš© ê·œì¹™
    - ì •ì±…: ì˜í™”ë³„ 1ê°œë§Œ ì ìš© ê°€ëŠ¥
    - ì¡°ê±´: ì—¬ëŸ¬ ê°œ ì§€ì • ê°€ëŠ¥ (ìˆœì„œ + ê¸°ê°„ í˜¼í•© ê°€ëŠ¥)
    
    | ì˜í™” | í• ì¸ ì •ì±… | í• ì¸ ì¡°ê±´ |
    | --- | --- | --- |
    | ì•„ë°”íƒ€ | ê¸ˆì•¡ í• ì¸ ì •ì±… (í• ì¸ì•¡: 800ì›) | ìˆœë²ˆ ì¡°ê±´(ì¡°ì¡°, 10íšŒ ìƒì˜) |
    | íƒ€ì´íƒ€ë‹‰ | ë¹„ìœ¨ í• ì¸ ì •ì±… (í• ì¸ìœ¨: 10%) | ê¸°ê°„ ì¡°ê±´(í™”ìš”ì¼ 14~17ì‹œ), ìˆœë²ˆ ì¡°ê±´(2íšŒ ìƒì˜) |
    | ìŠ¤íƒ€ì›Œì¦ˆ | ì—†ìŒ |  |
5. ì˜ˆë§¤ ì •ë³´ êµ¬ì¡°
    
    
    | í•­ëª© | ì„¤ëª… |
    | --- | --- |
    | ì˜í™” ì œëª© | ì˜ˆë§¤í•œ ì˜í™” ì´ë¦„ |
    | ìƒì˜ ì •ë³´ | ìƒì˜ ë‚ ì§œ, ì‹œê°„, ìˆœë²ˆ |
    | ì˜ˆì•½ ì¸ì› | ì˜ˆë§¤ ì¸ì› |
    | ì •ê°€ | ê¸°ë³¸ ì˜í™” ê°€ê²© |
    | ê²°ì œ ê¸ˆì•¡ | í• ì¸ ì ìš© í›„ ìµœì¢… ê²°ì œ ê¸ˆì•¡ |

## ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì„ í–¥í•´

### í˜‘ë ¥, ê°ì²´, í´ë˜ìŠ¤

**ê°ì²´ ì¤‘ì‹¬ ì‚¬ê³ **

- ê°ì²´ì§€í–¥ = ê°ì²´ë¥¼ ì§€í–¥
- í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ê°ì²´ì— ì´ˆì ì„ ë§ì¶°ì•¼ í•œë‹¤.
    - í´ë˜ìŠ¤ë¶€í„° ê³ ë¯¼í•˜ëŠ” ìŠµê´€ì€ ê°ì²´ì§€í–¥ì˜ ë³¸ì§ˆê³¼ ë‹¤ë¥´ë‹¤.
    - ìš°ì„  ì–´ë–¤ ê°ì²´ê°€ í•„ìš”í•œì§€, ê·¸ ê°ì²´ê°€ ë¬´ì—‡ì„ ì•Œê³  ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ì§€ ê³ ë¯¼í•´ì•¼ í•œë‹¤.

**í´ë˜ìŠ¤**

- ê³µë™ì ì¸ ìƒíƒœì™€ í–‰ë™ì„ ê³µìœ í•˜ëŠ” ê°ì²´ë“¤ì„ ì¶”ìƒí™”í•œ ê²ƒ
    - í´ë˜ìŠ¤ì˜ ìœ¤ê³½ì„ ì¡ê¸° ìœ„í•´ ê°ì²´ì˜ ìƒíƒœì™€ í–‰ë™, í˜‘ë ¥ ê´€ê³„ê°€ ëª…í™•íˆ í•´ì•¼í•œë‹¤.

**ê°ì²´**

- ìƒíƒœ+ í–‰ë™
- ë…ë¦½ì ì¸ ì¡´ì¬ê°€ ì•„ë‹ˆë¼ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ í˜‘ë ¥í•˜ëŠ” ê³µë™ì²´ì˜ ì¼ì›ìœ¼ë¡œ ìƒê°í•œë‹¤.
    - ì„¤ê³„ê°€ ìœ ì—°í•˜ê³  í™•ì¥ ê°€ëŠ¥
- í˜‘ë ¥ì˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•˜ë©´ ê°ì²´ì˜ ì—­í• ê³¼ ì±…ì„ì´ ëª…í™•í•´ì§

**ê²°ë¡ : ì¢‹ì€ í˜‘ë ¥ â†’ ì¢‹ì€ ê°ì²´ â†’ ì¢‹ì€ í´ë˜ìŠ¤**

### ë„ë©”ì¸ì˜ êµ¬ì¡°ë¥¼ ë”°ë¥´ëŠ” í”„ë¡œê·¸ë¨ êµ¬ì¡°

**ë„ë©”ì¸(Domain)**

- ì†Œí”„íŠ¸ì›¨ì–´ê°€ í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ ì˜ì—­ì„ ë„ë©”ì¸ì´ë¼ê³  í•œë‹¤.
    - ì˜í™” ì˜ˆë§¤ ì‹œìŠ¤í…œì˜ ë„ë©”ì¸: ì‚¬ìš©ìê°€ ì˜í™”ë¥¼ ì‰½ê³  ë¹ ë¥´ê²Œ ì˜ˆë§¤í•˜ëŠ” ê²ƒ

ê°ì²´ì§€í–¥ íŒ¨ëŸ¬ë‹¤ì„ì—ì„œëŠ” ìš”êµ¬ì‚¬í•­ì„ ë¶„ì„í•˜ëŠ” ì´ˆê¸° ë‹¨ê³„ë¶€í„° í”„ë¡œê·¸ë¨ì„ êµ¬í˜„í•˜ëŠ” ë§ˆì§€ë§‰ ë‹¨ê³„ê¹Œì§€ ê°ì²´ë¼ëŠ” ë™ì¼í•œ ì¶”ìƒí™” ê¸°ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

â‡’ í”„ë¡œê·¸ë¨ì˜ ê°ì²´/í´ë˜ìŠ¤ì™€ ë§¤ë„ëŸ½ê²Œ ì—°ê²° ê°€ëŠ¥

| ë„ë©”ì¸ ê°œë… | ëŒ€ì‘ í´ë˜ìŠ¤ | ì„¤ëª… |
| --- | --- | --- |
| ì˜í™” | `Movie` | ì˜í™” ì •ë³´(ì œëª©, ìƒì˜ì‹œê°„, ê¸°ë³¸ ê°€ê²©, í• ì¸ ì •ì±…) |
| ìƒì˜ | `Screening` | íŠ¹ì • ì‹œê°„ëŒ€ ì˜í™” ìƒì˜, ìˆœë²ˆ í¬í•¨ |
| ì˜ˆë§¤ | `Reservation` | ì‚¬ìš©ìì˜ ì˜ˆë§¤ ì •ë³´(ìƒì˜, ì¸ì›, ê²°ì œê¸ˆì•¡) |
| í• ì¸ ì •ì±… | `DiscountPolicy` | ê¸ˆì•¡/ë¹„ìœ¨ í• ì¸ ì •ì±… ì¶”ìƒí™” |
| ê¸ˆì•¡ í• ì¸ ì •ì±… | `AmountDiscountPolicy` | ì •ì•¡ í• ì¸ êµ¬í˜„ |
| ë¹„ìœ¨ í• ì¸ ì •ì±… | `PercentDiscountPolicy` | ë¹„ìœ¨ í• ì¸ êµ¬í˜„ |
| í• ì¸ ì¡°ê±´ | `DiscountCondition` | í• ì¸ ì ìš© ì—¬ë¶€ íŒë‹¨ |
| ìˆœë²ˆ ì¡°ê±´ | `SequenceCondition` | ìƒì˜ ìˆœë²ˆ ê¸°ë°˜ í• ì¸ ì¡°ê±´ |
| ê¸°ê°„ ì¡°ê±´ | `PeriodCondition` | ìƒì˜ ì‹œê°„ ê¸°ë°˜ í• ì¸ ì¡°ê±´ |

```mermaid
classDiagram
direction LR
		Reservation -- "1" Screening
    Screening -- "1" Movie
    Movie "1" -- "0..1" DiscountPolicy
    DiscountPolicy "1" -- "1..*" Discount Condition

		Amount DiscountPolicy --|> DiscountPolicy
    Percent DiscountPolicy --|> DiscountPolicy
    
    Discount Condition <|-- Sequence Condition
    Discount Condition <|-- Period Condition

```

- í•˜ë‚˜ì˜ `Screening`ì€ í•˜ë‚˜ì˜ `Movie`ì™€ ì—°ê²°
- í•˜ë‚˜ì˜ `Reservation`ì€ í•˜ë‚˜ì˜ `Screening`ê³¼ ì—°ê²°
- `Movie`ëŠ” í•˜ë‚˜ì˜ í• ì¸ ì •ì±…ë§Œ ê°€ì§ˆ ìˆ˜ ìˆìŒ, í• ì¸ ì •ì±…ì´ ì¡´ì¬í•˜ë©´ í•˜ë‚˜ ì´ìƒì˜ í• ì¸ ì¡°ê±´ í¬í•¨
- í• ì¸ ì •ì±…ì€ ê¸ˆì•¡ í• ì¸ ì •ì±… ë˜ëŠ” ë¹„ìœ¨ í• ì¸ ì •ì±…ìœ¼ë¡œ êµ¬í˜„
- í• ì¸ ì¡°ê±´ì€ ìˆœë²ˆ ì¡°ê±´ ë˜ëŠ” ê¸°ê°„ ì¡°ê±´ìœ¼ë¡œ êµ¬í˜„

### í´ë˜ìŠ¤ êµ¬í˜„í•˜ê¸°

`Screening` í´ë˜ìŠ¤ëŠ” ì‚¬ìš©ìê°€ ì˜ˆë§¤í•˜ëŠ” ìƒì˜ì„ êµ¬í˜„

- ìƒì˜ ì •ë³´(ì˜í™”, ìˆœë²ˆ, ì‹œì‘ ì‹œê°„)ë¥¼ ê°ì²´ë¡œ ìº¡ìŠí™”

```java
public class Screening {
	private Movie movie:
	private int sequence;
	private LocalDateTime whenScreened;
	
	public Screening(Movie movie, int sequence, LocalDateTime whenScreened) {
		this.movie = movie;
		this.sequence = sequence;
		this.whenScreened = whenScreened;
	}
	
	// ìƒì˜ ì‹œì‘ ì‹œê°„ì„ ë°˜í™˜
	public LocalDateTime getStartTime() {
		return whenScreened;
	}
	
	// ìˆœë²ˆì˜ ì¼ì¹˜ ì—¬ë¶€ë¥¼ ê²€ì‚¬
	public boolean isSequence(int sequence) {
		return this.sequence == sequence;
	}
	
	// ê¸°ë³¸ ìš”ê¸ˆì„ ë°˜í™˜
	public Money getMovieFee() {
		return movie.getFee();
	}
}
```

**ì£¼ëª©í•  ì : ì ‘ê·¼ ì œí•œì**

- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜(private): ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€
- ë©”ì„œë“œ(public): ì™¸ë¶€ì—ì„œ ê°ì²´ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” í†µë¡œ
- public ë©”ì„œë“œë¥¼ í†µí•´ì„œë§Œ ë‚´ë¶€ ìƒíƒœë¥¼ ë³€ê²½ í•  ìˆ˜ ìˆë‹¤.

**â“ì™œ í´ë˜ìŠ¤ì˜ ë‚´ë¶€ì™€ ì™¸ë¶€ë¥¼ êµ¬ë¶„í•´ì•¼ í• ê¹Œâ“**

1. **ììœ¨ì ì¸ ê°ì²´**

**ê°ì²´**

- ìƒíƒœ(State) + í–‰ë™(Behavior)ì„ í•¨ê»˜ ê°€ì§€ëŠ” ë³µí•©ì  ì¡´ì¬
- ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ê³  í–‰ë™í•˜ëŠ” ììœ¨ì ì¸ ì¡´ì¬
    
    
    ì´ì „ íŒ¨ëŸ¬ë‹¤ì„ì—ì„œëŠ” ë°ì´í„°ì™€ ê¸°ëŠ¥ì´ ë…ë¦½ì  ì¡´ì¬ì˜€ì§€ë§Œ 
    
    ê°ì²´ì§€í–¥ íŒ¨ëŸ¬ë‹¤ì„ì—ì„œëŠ” ê°ì²´ ë‹¨ìœ„ë¡œ ë°ì´í„°ì™€ ê¸°ëŠ¥ì„ í•˜ë‚˜ë¡œ ë¬¶ëŠ”ë‹¤.
    
    â†’ **ìº¡ìŠí™”(Encapsulation)**
    

**ì ‘ê·¼ ì œì–´**

- ê°ì²´ ë‚´ë¶€ì˜ ìƒíƒœì™€ í–‰ë™ì„ ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ë³´í˜¸
- `public`, `protected`, `private`
- ëª©ì : ê°ì²´ì˜ ììœ¨ì„± ë³´ì¥(ì™¸ë¶€ ê°„ì„­ ìµœì†Œí™”)
    - ì™¸ë¶€ì—ì„œ ìƒíƒœë¥¼ ì§ì ‘ ë³€ê²½ ë¶ˆê°€
    - ì™¸ë¶€ëŠ” ê°ì²´ì—ê²Œ ìš”ì²­ë§Œ í•˜ê³  ë‚´ë¶€ ê²°ì •ì€ ê°ì²´ê°€ ìŠ¤ìŠ¤ë¡œ ìˆ˜í–‰

**í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ vs êµ¬í˜„**

|  | ì„¤ëª… |
| --- | --- |
| í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤(Public Interface) | ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥. ê°ì²´ì™€ ìƒí˜¸ì‘ìš© |
| êµ¬í˜„(Implementation) | ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ë¶ˆê°€, ê°ì²´ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©. |
- ì„¤ê³„ ì›ì¹™: ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì˜ ë¶„ë¦¬(Separation of Interface and Implementation)
- ë°©ë²•
    - ê°ì²´ì˜ ìƒíƒœëŠ” ìˆ¨ê¸°ê³ , í–‰ë™ë§Œ ì™¸ë¶€ì— ê³µê°œí•œë‹¤.
    - ì†ì„± â†’ `private`
    - ì™¸ë¶€ ê³µê°œ ë©”ì„œë“œ â†’ `public`
    - ì„œë¸Œí´ë˜ìŠ¤, ë‚´ë¶€ ì ‘ê·¼ìš© â†’ `protected` / `private`
    - í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì—ëŠ” publicìœ¼ë¡œ ì§€ì •ëœ ë©”ì„œë“œë§Œ í¬í•¨í•œë‹¤.

1. **í”„ë¡œê·¸ë˜ë¨¸ì˜ ììœ **
    
    
    | í”„ë¡œê·¸ë˜ë¨¸ì˜ ì—­í•  | ì„¤ëª… |
    | --- | --- |
    | í´ë˜ìŠ¤ ì‘ì„±ì(Class Creator) | ìƒˆë¡œìš´ ë°ì´í„° íƒ€ì…ì„ ì„¤ê³„Â·ì‘ì„± |
    | í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë˜ë¨¸(Client Programmer) | ì‘ì„±ëœ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶• |
    
    **êµ¬í˜„ ì€ë‹‰(Implementation Hiding)**
    
    - í´ë˜ìŠ¤ ì‘ì„±ìëŠ” í•„ìš”í•œ ë¶€ë¶„ë§Œ ê³µê°œ(public), ë‚˜ë¨¸ì§€ëŠ” ìˆ¨ê¹€(private/protected)
    - í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë˜ë¨¸ê°€ ë‚´ë¶€ êµ¬í˜„ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€
    - ëª©ì 
        1. ì™¸ë¶€ ì˜í–¥ ìµœì†Œí™”: í´ë˜ìŠ¤ ì‘ì„±ìëŠ” ë‚´ë¶€ êµ¬í˜„ì„ ììœ ë¡­ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. 
        2. ì¸ì§€ ë¶€ë‹´ ê°ì†Œ: í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë˜ë¨¸ëŠ” ë‚´ë¶€ì˜ êµ¬í˜„ì„ ëª°ë¼ë„ ì¸í„°í˜ì´ìŠ¤ë§Œ ì•Œê³  ìˆìœ¼ë©´ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    

### í˜‘ë ¥í•˜ëŠ” ê°ì²´ë“¤ì˜ ê³µë™ì²´

**Screening**

- `reserve(customer, audienceCount)`ë¼ëŠ” ë©”ì‹œì§€ë¥¼ ë°›ëŠ”ë‹¤.
- ìš”ê¸ˆ ê³„ì‚°ì€ Movie.calculateMovieFee ì—ê²Œ ìœ„ì„

```java
public class Screening {
	public Reservation reserve(Customer customer, int audienceCount) {
		return new Reservation(customer, this, calculateFee(audienceCount), audienceCount);
	}
	
	// Screeningì€ ìš”ê¸ˆì— ì¸ì›ìˆ˜ë§Œ ê³±í•˜ëŠ” ì—­í• 
	private Money calculateFee(int audienceCount) {
		return movie.calculateMovieFee(this).times(audienceCount);
	}
}
```

**Money**

- `Long` ê°™ì€ ì›ì‹œê°’ì„ ì“°ëŠ” ëŒ€ì‹  ë„ë©”ì¸ ê°œë…ì„ í‘œí˜„í•˜ëŠ” ì „ìš© íƒ€ì… ì‚¬ìš©
- ì¥ì 
    - "ëˆ"ì´ë¼ëŠ” ì˜ë¯¸ë¥¼ ëª…í™•í•˜ê²Œ ì „ë‹¬
    - ê¸ˆì•¡ ê³„ì‚° ë¡œì§(`plus`, `minus`, `times`)ì„ í•œ ê³³ì— ëª¨ì•„ ì¤‘ë³µ ì œê±°
    - ëª…í™•ì„±ê³¼ ìœ ì—°ì„± í™•ë³´
    
    ```java
    public class Money {
    	public static final Money ZERO = Money.wons(0);
    	private final BigDecimal amount;
    	
    	public static Money wons(long amount) {
    		return new Money(BigDecimal.valueOf(amount));
    	}
    	
    	public static Money wons(double amount) {
    		return new Money(BigDecimal.valueOf(amount));
    	}
    	
    	Money(BigDecimal amount) {
    		this.amount = amount;
    	}
    	
    	public Money plus(Money amount) {
    		return new Money(this.amount.add(amount.amount));
    	}
    	
    	public Money minus(Money amount) {
    		return new Money(this.amount.subtract(amount.amount));
    	}
    	
    	public Money times(double percent) {
    		return new Money(this.amount.multiply(
    		BigDecimal.valueOf(percent)));
    	}
    	
    	public boolean isLessThan(Money other) {
    		return amount.compareTo(other.amount) < 0;
    	}
    	
    	public boolean isGreaterThanOrEqual(Money other) {
    		return amount.compareTo(other.amount) >= 0;
    	}
    }
    ```
    

**Reservation** 

- `Customer`, `Screening`, `Money fee`, `audienceCount`ë¥¼ ì†ì„±ìœ¼ë¡œ í¬í•¨í•˜ë©° ì„œë¡œì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©° ìƒí˜¸ì‘ìš©í•œë‹¤.
- í˜‘ë ¥ì˜ ìµœì¢… ì‚°ì¶œë¬¼ ì—­í• 

```java
public class Reservation {
	private Customer customer;
	private Screening screening;
	private Money fee:
	private int audienceCount;
	
	public Reservation(Customer customer, Screening screening, Money fee, int audienceCount) {
		this.customer = customer;
		this.screening = screening;
		this.fee = fee;
		this.audienceCount = audienceCount;
	}
}
```

ì¸ìŠ¤í„´ìŠ¤ ì‚¬ì´ì˜ í˜‘ë ¥

```mermaid
sequenceDiagram
    participant Customer
    participant Screening
    participant Movie
    participant Reservation

    Customer ->> Screening: reserve(customer, count)
    Screening ->> Screening: calculateFee(count)
    Screening ->> Movie: calculateMovieFee(screening)
    Movie -->> Screening: fee per person
    Screening ->> Reservation: new Reservation(customer, screening, totalFee, count)
    Screening -->> Customer: Reservation
```

**ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•  ë•Œ**

1. í˜‘ë ¥ì˜ ê´€ì ì—ì„œ ì–´ë–¤ ê°ì²´ê°€ í•„ìš”í•œì§€ ê²°ì •
2. ê³µë™ ìƒíƒœì™€ í–‰ìœ„ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ í´ë˜ìŠ¤ë¥¼ ì‘ì„±
3. í˜‘ë ¥ì´ ë¨¼ì € ê²°ì •ë˜ë©´, ê·¸ í˜‘ë ¥ ì†ì—ì„œ **ì—­í•  â†’ ì±…ì„ â†’ í´ë˜ìŠ¤**ê°€ ë„ì¶œëœë‹¤.

### í˜‘ë ¥ì— ê´€í•œ ì§§ì€ì´ì•¼ê¸°

ê°ì²´ëŠ” ë‹¤ë¥¸ ê°ì²´ì˜ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ìš”ì²­(request)í•  ìˆ˜ ìˆë‹¤. ìš”ì²­ì„ ë°›ì€ ê°ì²´ëŠ” ììœ¨ì ì¸ ë°©ë²•ì— ë”°ë¼ ìš”ì²­ì„ ì²˜ë¦¬í•œ í›„ ì‘ë‹µ(response)í•œë‹¤. ê°ì²´ê°€ ë‹¤ë¥¸ ê°ì²´ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ëŠ” ê²ƒë¿ì´ë‹¤.

**ë©”ì‹œì§€ì™€ ë©”ì„œë“œ**

- ë©”ì‹œì§€ (Message): ì¸í„°í˜ì´ìŠ¤
    - ê°ì²´ ê°„ í˜‘ë ¥ì˜ ìš”ì²­
    - ë³´ë‚¸ ê°ì²´ëŠ” ìˆ˜ì‹ ìê°€ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ëª¨ë¥¸ë‹¤. â€œì‘ë‹µí•  ìˆ˜ ìˆë‹¤â€ëŠ” ë¯¿ìŒë§Œ ê°€ì§€ê³  ìˆë‹¤.
- ë©”ì„œë“œ (Method): êµ¬í˜„
    - ê°ì²´ê°€ ë°›ì€ ë©”ì‹œì§€ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
    - ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ìì‹ ë§Œì˜ ë°©ë²•

ğŸ‘‰ ê°ì²´ì§€í–¥ì€ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì˜ ë¶„ë¦¬ë¥¼ ì „ì œë¡œ í•œë‹¤.

**ê°ì²´ì˜ ììœ¨ì„±**

Screeningì€ Movie ì•ˆì— `calculateMovieFee` ë©”ì„œë“œê°€ ì–´ë–»ê²Œ êµ¬í˜„ëëŠ”ì§€ ëª¨ë¥¸ë‹¤. ê·¸ì € Movieê°€ ì´ ë©”ì‹œì§€ë¥¼ ì´í•´í•  ìˆ˜ ìˆë‹¤ê³  ë¯¿ê³  ìš”ì²­í•œë‹¤. ê·¸ ë©”ì‹œì§€ë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í• ì§€ëŠ” Movieì˜ ììœ ë‹¤.

## í• ì¸ ìš”ê¸ˆ êµ¬í•˜ê¸°

### í• ì¸ ìš”ê¸ˆ ê³„ì‚°ì„ ìœ„í•œ í˜‘ë ¥ ì‹œì‘í•˜ê¸°

**Movie**

- ìƒì˜ì‹œê°„, ê¸°ë³¸ ìš”ê¸ˆ, í• ì¸ ì •ì±…ì„ ì†ì„±ìœ¼ë¡œ ê°€ì§„ë‹¤.

```java
public class Movie {
	private String title
	private Duration runningTime
	private Money fee
	private DiscountPolicy discountPolicy
	
	public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy) {
		this.title = title;
		this.runningTime = runningTime;
		this.fee = fee;
		this.discountPolicy = discountPolicy:
	}
	
	public Money getFee() {
		return fee;
	}
	
	public Money calculateMoviefee(Screening screening) {
		// í• ì¸ëœ ìš”ê¸ˆ ë°˜í™˜
		return fee.minus(discountPolicy.calculateDiscountAmount(screening));
	}
}
```

ì–´ë–¤ í• ì¸ ì •ì±…ì„ ì‚¬ìš©í•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. MovieëŠ” discountPolicyì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ë¿ì´ë‹¤.

### í• ì¸ ì •ì±…ê³¼ í• ì¸ ì¡°ê±´

**DiscountPolicy** 

- ì¶”ìƒ í´ë˜ìŠ¤ (abstract class)
    - ëª¨ë“  í• ì¸ ì •ì±…ì´ ë”°ë¼ì•¼ í•  ê³¨ê²©ì„ ì •ì˜
    - ê³µí†µ íë¦„: í• ì¸ ì¡°ê±´ë“¤ì„ ê²€ì‚¬ â†’ ë§Œì¡±í•˜ë©´ í• ì¸ê¸ˆì•¡ ë°˜í™˜ â†’ ì•„ë‹ˆë©´ 0 ë°˜í™˜

```java
public abstract class DiscountPolicy {
	// í•˜ë‚˜ì˜ í• ì¸ ì •ì±…ì€ ì—¬ëŸ¬ ê°œì˜ í• ì¸ ì¡°ê±´ì„ í¬í•¨í•  ìˆ˜ ìˆë‹¤.
	private List<DiscountCondition> conditions = new ArrayList<>();
	
	public DiscountPolicy(DiscountCondition ... conditions) {
		this.conditions = Arrays.asList(conditions);
	}
	
	public Money calculateDiscountAmount(Screening screening) {
		for(DiscountCondition each : conditions) {
			// í• ì¸ ì¡°ê±´ í™•ì¸
			if (each.isSatisfiedBy(screening)) {
				return getDiscountAmount(screening);
			}
		}
		
		// ë§Œì¡±í•˜ëŠ” í• ì¸ ì¡°ê±´ ì—†ìŒ
		return Money.ZERO;
	}
	
	// ì¶”ìƒ ë©”ì„œë“œ. ì‹¤ì œ ìš”ê¸ˆ ê³„ì‚°
	abstract protected Money getDiscountAmount(Screening Screening);
}
```

- ê³µí†µ ë¡œì§ì€ ìƒì† ê³„ì¸µì˜ ë¶€ëª¨ì—, ì„¸ë¶€ êµ¬í˜„ì€ ìì‹ì— ìœ„ì¹˜ì‹œì¼œ ì¤‘ë³µ ì œê±°
- TEMPLATE METHOD íŒ¨í„´

**DiscountCondition**

- ë‹¤ì–‘í•œ ì¡°ê±´(ìˆœë²ˆ, ê¸°ê°„ ë“±)ì„ ì „ëµ(Strategy)ì²˜ëŸ¼ ë¼ì›Œ ë„£ì„ ìˆ˜ ìˆë‹¤.

```java
public interface DiscountCondition {
	boolean isSatisfiedBy(Screening screening);
}
```

```java
public class SequenceCondition implements DiscountCondition {
	private int sequence:
	
	public SequenceCondition(int sequence) {
		this.sequence = sequence;
	}
	
	// Screeningì˜ ìƒì˜ ìˆœë²ˆê³¼ ì¼ì¹˜í•  ê²½ìš° í• ì¸
	public boolean isSatisfiedBy(Screening screening) {
		return screening.isSequence(sequence);
	}
}

public class PeriodCondition implements DiscountCondition {
	private DayOfWeek dayOfWeek;
	private LocalTime startTime;
	private LocalTime endTime:
	
	public PeriodCondition(DayOfWeek dayOfWeek, LocalTime startTime, LocalTime endTime) {
		this.dayOfWeek = dayOfWeek;
		this.startTime = startTime;
		this.endTime = endTime:
	}
	
	// ìƒì˜ ì‹œì‘ ì‹œê°„ì´ íŠ¹ì •í•œ ê¸°ê°„ ì•ˆì— í¬í•¨ë  ê²½ìš° í• ì¸
	public boolean isSatisfiedBy(Screening screening) {
		return screening.getStartTime().getDayOfWeek().equals(dayDfWeek) 8&
			startTime.compareTo(screening.getStartTime().toLocalTime()) <= 0 8&
			endTime.compareTo(screening.getStartTime().toLocalTime()) >= 0;
	}
}
```

**DiscountPolicy êµ¬í˜„ì²´**

- DiscountPolicy ì˜ ì¶”ìƒ ë©”ì„œë“œì¸ getDiscountAnount()ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•œë‹¤.

```java
public class AmountDiscountPolicy extends DiscountPolicy {
	private Money discountAmount;
	
	public AmountDiscountPolicy(Money discountAmount, DiscountCondition ... conditions) {
		super(conditions);
		this.discountAmount = discountAmount;
	}
	
	@0verride
	protected Money getDiscountAmount(Screening screening) {
		// ê³ ì • ê¸ˆì•¡ í• ì¸
		return discountAmount;
	}
}

public class PercentDiscountPolicy extends DiscountPolicy {
	private double percent;
	
	public PercentDiscountPolicy(double percent, DiscountCondition ... conditions) {
	super(conditions);
	this.percent = percent;
	}
		
	@0verride
	protected Money getDiscountAmount(Screening screening) {
		// ë¹„ìœ¨ í• ì¸
		return screening.getMovieFee().times(percent);
	}
}
```

```mermaid
classDiagram
direction LR
		
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class Amount DiscountPolicy{
			# getDiscountAmount()
		}
		class Percent DiscountPolicy{
			# getDiscountAmount()
		}
		class DiscountCondition{
			+ isSatisfiedBy()
		}
		class SequenceCondition{
			+ isSatisfiedBy()
		}
		class PeriodCondition{
			+ isSatisfiedBy()
		}
		
    Movie --> DiscountPolicy : discountPolicy
    DiscountPolicy --> DiscountCondition : conditions

		Amount DiscountPolicy --|> DiscountPolicy
    Percent DiscountPolicy --|> DiscountPolicy
    
    Discount Condition <|.. Sequence Condition
    Discount Condition <|.. Period Condition

    <<interface>> DiscountPolicy
    <<interface>> DiscountCondition

```

- `Movie` â†’ `DiscountPolicy`ë¥¼ ìœ„ì„í•´ì„œ ì˜í™” ìš”ê¸ˆì„ ê³„ì‚°
- `DiscountPolicy` â†’ ì—¬ëŸ¬ `DiscountCondition`ì„ ì¡°í•©í•´ í™œìš©

ì •ì±…ì€ ì¡°ê±´ì„ í¬í•¨í•˜ê³ , ì˜í™”ëŠ” ì •ì±…ì„ ìœ„ì„ë°›ì•„ ìš”ê¸ˆ ê³„ì‚°í•œë‹¤.

**ì¥ì **

- ì¤‘ë³µ ì œê±°: ê³µí†µ íë¦„ì€ ë¶€ëª¨ ì¶”ìƒ í´ë˜ìŠ¤ì—
- ìœ ì—°í•œ í™•ì¥: ì •ì±…ê³¼ ì¡°ê±´ì„ ë…ë¦½ì ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥
- OCP(ê°œë°©-íì‡„ ì›ì¹™) ì¤€ìˆ˜: ìƒˆë¡œìš´ í• ì¸ ì •ì±…/ì¡°ê±´ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
- ì¡°ë¦½ ê°€ëŠ¥ì„±: ì˜í™”ë§ˆë‹¤ ë‹¤ë¥¸ ì •ì±…+ì¡°ê±´ì„ ì‰½ê²Œ ì¡°í•© ê°€ëŠ¥

### í• ì¸ ì •ì±… êµ¬ì„±í•˜ê¸°

1. í• ì¸ ì •ì±…ì€ ì˜í™”ë‹¹ 1ê°œë§Œ ê°€ëŠ¥
    - `Movie` ìƒì„±ìì—ì„œ `DiscountPolicy`ë¥¼ ë‹¨ í•˜ë‚˜ë§Œ ë°›ë„ë¡ ê°•ì œ
    
    ```java
    public class Movie {
    	public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy) {
    		this.discountPolicy = discountPolicy;
    	}
    }
    ```
    

1. í• ì¸ ì¡°ê±´ì€ ì—¬ëŸ¬ ê°œ ê°€ëŠ¥
    
    ```java
    public abstract class DiscountPolicy {
    	private List<DiscountCondition> conditions;
    	
    	// ìƒì„±ìì—ì„œ DiscountCondition... ê°€ë³€ ì¸ìë¥¼ ë°›ìŒ
    	public DiscountPolicy(DiscountCondition ... conditions) {
    		this.conditions = Arrays.asList(conditions);
    	}
    }
    ```
    

**ì•„ë°”íƒ€**

- **ì •ì±…**: ê¸ˆì•¡ í• ì¸ (800ì› í• ì¸)
- **ì¡°ê±´**:
    - 1íšŒì°¨ ìƒì˜
    - 10íšŒì°¨ ìƒì˜
    - ì›”ìš”ì¼ 10:00~11:59
    - ëª©ìš”ì¼ 10:00~20:59
    
    ```java
    Movie avatar = new Novie("ì•„ë°”íƒ€",
    	Duration.ofMinutes(128),
    	Money.wons(10009),
    	new AmountDiscountPolicy(Money.wons(800),
    			new SequenceCondition(1),
    			new SequenceCondition(10),
    			new PeriodCondition(DayOfWeek.MONDAY, LocalTime.of(10, @), LocalTime.of(11, 59)),
    			new PeriodCondition(DayOfWeek.THURSDAY, LocalTime.of(10, @), LocalTime.of(20, 59))));
    ```
    

**íƒ€ì´íƒ€ë‹‰**

- **ì •ì±…**: ë¹„ìœ¨ í• ì¸ (10%)
- **ì¡°ê±´**:
    - í™”ìš”ì¼ 14:00~16:59
    - 2íšŒì°¨ ìƒì˜
    - ëª©ìš”ì¼ 10:00~13:59
    
    ```java
    Movie titanic = new Movie("íƒ€ì´íƒ€ë‹‰",
    	Duration.ofMinutes(188),
    	Money.wons(1100@),
    	new PercentDiscountPolicy(0.1,
    			new PeriodCondition(DayOfWeek.TUESDAY, LocalTime.of(14, @), LocalTime.of(16, 59)),
    			new SequenceCondition(2),
    			new PeriodCondition(DayOfWeek.THURSDAY, LocalTime.of(10, @), LocalTime.of(13, 59))));
    ```
    

- ìƒˆë¡œìš´ í• ì¸ ì¡°ê±´ ì¶”ê°€í•˜ë ¤ë©´ `DiscountCondition`ë§Œ êµ¬í˜„í•˜ë©´ ëœë‹¤.
- ì˜í™”ë‹¹ í• ì¸ ì •ì±…ì€ í•˜ë‚˜ë§Œ, ì¡°ê±´ì€ ì—¬ëŸ¬ ê°œë¥¼ ìƒì„±ìì—ì„œ ê°•ì œí•˜ê³  ìˆë‹¤.
- ê°ì²´ ì¡°ë¦½ë§Œìœ¼ë¡œ ì •ì±… ë³€ê²½ ê°€ëŠ¥

## ìƒì†ê³¼ ë‹¤í˜•ì„±

Movie ë‚´ë¶€ì— í• ì¸ ì •ì±…ì„ ê²°ì •í•˜ëŠ” ì¡°ê±´ë¬¸ì´ ì—†ëŠ”ë° 

ì–´ë–»ê²Œ ì˜í™” ìš”ê¸ˆì„ ê³„ì‚°í•  ë•Œ ì •ì±…ì„ ì„ íƒí•  ìˆ˜ ìˆì„ê¹Œâ“  ğŸ‘‰ ìƒì†ê³¼ ë‹¤í˜•ì„±

### ì»´íŒŒì¼ ì‹œê°„ ì˜ì¡´ì„±ê³¼ ì‹¤í–‰ ì‹œê°„ ì˜ì¡´ì„±

```mermaid
classDiagram
direction LR
		
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class Amount DiscountPolicy{
			# getDiscountAmount()
		}
		class Percent DiscountPolicy{
			# getDiscountAmount()
		}

		
    Movie --> DiscountPolicy : discountPolicy

		Amount DiscountPolicy --|> DiscountPolicy
    Percent DiscountPolicy --|> DiscountPolicy

    <<interface>> DiscountPolicy

```

**ì‹¤í–‰ ì‹œì  ì˜ì¡´ì„±ê³¼ ëŸ°íƒ€ì„ ì˜ì¡´ì„±ì´ ë‹¤ë¥´ë‹¤**.

- ì»´íŒŒì¼ ì‹œì : `Movie`ëŠ” ì˜¤ì§ `DiscountPolicy`(ì¶”ìƒ í´ë˜ìŠ¤)ì—ë§Œ ì˜ì¡´í•œë‹¤.
- ì‹¤í–‰ ì‹œì : ì‹¤ì œ ê°ì²´ëŠ” `AmountDiscountPolicy` ë˜ëŠ” `PercentDiscountPolicy`ê°€ ì£¼ì…ëœë‹¤.

**ì˜ˆì‹œ**

```java
Movie avatar = new Novie("ì•„ë°”íƒ€",
	Duration.ofMinutes(120),
	Money.wons(10000),
	new AmountDiscountPolicy(Money.wons(800), ... ));
```

```mermaid
flowchart LR
    A[":Movie
			title = ì•„ë°”íƒ€
			duration= 120ë¶„"] 
			
		 B[":Amount
				DiscountPolicy
				discountAmount = 800ì›"]
				
		A --- B
    
    
```

ì´ì œ ì‹¤í–‰ ì‹œì— Movie ì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” AmountDiscountPolicy í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì— ì˜ì¡´í•œë‹¤.

```java
Movie avatar = new Novie("ì•„ë°”íƒ€",
	Duration.ofMinutes(120),
	Money.wons(10000),
	new PercentDiscountPolicy(0.1, ... ));
```

```mermaid
flowchart LR
    A[":Movie
			title = ì•„ë°”íƒ€
			duration= 120ë¶„"] 
			
		 B[":Amount
				DiscountPolicy
				percent = 10%"]
				
		A --- B
    
    
```

ë¹„ìœ¨ í• ì¸ ì •ì±…ì„ ì ìš©í•˜ê³  ì‹¶ë‹¤ë©´ PercentDiscountPolicyì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.

**ìœ ì—°ì„±ê³¼ ê°€ë…ì„±ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„**

- ì„¤ê³„ê°€ ìœ ì—°í•´ì§ˆìˆ˜ë¡ ì¬ì‚¬ìš©ì„±ê³¼ í™•ì¥ ê°€ëŠ¥ì„±ì´ ì¢‹ì•„ì§„ë‹¤.
    - MovieëŠ” ì •ì±…ì˜ ì¢…ë¥˜ë¥¼ ëª°ë¼ë„ ëœë‹¤.
    - ì½”ë“œ ìˆ˜ì • ì—†ì´ ìƒˆë¡œìš´ ì •ì±…ì„ ë„ì…í•  ìˆ˜ ìˆë‹¤. (í™•ì¥ì„± â†‘, ì¬ì‚¬ìš©ì„± â†‘)
- ì„¤ê³„ê°€ ìœ ì—°í•´ì§ˆìˆ˜ë¡ ì½”ë“œë¥¼ ì´í•´í•˜ê³  ë””ë²„ê¹…í•˜ê¸°ëŠ” ì ì  ë” ì–´ë ¤ì›Œì§„ë‹¤.
    - Movie ì½”ë“œë§Œ ë´ì„œëŠ” ì‹¤ì œë¡œ ì–´ë–¤ í• ì¸ ì •ì±…ì´ ì ìš©ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.
    - ì˜ì¡´í•˜ê³  ìˆëŠ” ê°ì²´ë¥¼ ì•Œê¸° ìœ„í•´ì„œëŠ” ì˜ì¡´ì„±ì„ ì—°ê²°í•˜ëŠ” ë¶€ë¶„ì„ ì°¾ì•„ë´ì•¼ í•œë‹¤. (ê°€ë…ì„± â†“, ë””ë²„ê¹… ë‚œì´ë„ â†‘)

ê²°êµ­ ì„¤ê³„ìëŠ” ìœ ì—°ì„± vs ë‹¨ìˆœì„± ì‚¬ì´ì—ì„œ ê· í˜•ì„ ì¡ì•„ì•¼ í•œë‹¤.

### ì°¨ì´ì— ì˜í•œ í”„ë¡œê·¸ë˜ë°

ì¶”ê°€í•˜ê³  ì‹¶ì€ í´ë˜ìŠ¤ê°€ ê¸°ì¡´ì˜ ì–´ë–¤ í´ë˜ìŠ¤ì™€ ë§¤ìš° í¡ì‚¬í•˜ë‹¤ë©´ 

1. ê·¸ í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì™€ ì•½ê°„ë§Œ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•´ì„œ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.
2. ê·¸ í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ì „í˜€ ìˆ˜ì •í•˜ì§€ ì•Šê³ ë„ ì¬ì‚¬ìš©í•œë‹¤. â†’ **ìƒì†**

**ìƒì†**

- ë¶€ëª¨ í´ë˜ìŠ¤ê°€ ê°€ì§€ê³  ìˆëŠ” ëª¨ë“  ì†ì„±ê³¼ í–‰ë™ì„ ìì‹ í´ë˜ìŠ¤ì— í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
- ë‹¤ë¥¸ ë¶€ë¶„ë§Œ ì˜¤ë²„ë¼ì´ë”©í•´ì„œ í•„ìš”í•œ í–‰ë™ë§Œ ìˆ˜ì •í•˜ê±°ë‚˜ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
    - `DiscountPolicy` â†’ `AmountDiscountPolicy`, `PercentDiscountPolicy`
        - ë¶€ëª¨: â€œí• ì¸ ê³„ì‚°â€ì´ë¼ëŠ” ì¶”ìƒ ë©”ì„œë“œ ì œê³µ.
        - ìì‹: êµ¬ì²´ì ìœ¼ë¡œ ê¸ˆì•¡ í• ì¸, ë¹„ìœ¨ í• ì¸ ë¡œì§ë§Œ ë‹¤ë¥´ê²Œ êµ¬í˜„.
- ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ì´ ë¹ ë¥¸ í™•ì¥ ê°€ëŠ¥ì´ ê°€ëŠ¥í•˜ë‹¤.

ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ë‹¤ë¥¸ ë¶€ë¶„ë§Œì„ ì¶”ê°€í•´ì„œ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì‰½ê³  ë¹ ë¥´ê²Œ ë§Œë“œëŠ” ë°©ë²•ì„ 

**ì°¨ì´ì— ì˜í•œ í”„ë¡œê·¸ë˜ë°(programming by difference)**ì´ë¼ í•œë‹¤. 

### ìƒì†ê³¼ ì¸í„°í˜ì´ìŠ¤

í”íˆ ìƒì†ì˜ ê°€ì¹˜ë¥¼ ì½”ë“œ ì¬ì‚¬ìš© ì´ë¼ê³  ìƒê°í•œë‹¤. í•˜ì§€ë§Œ ë³¸ì§ˆì€ ì¸í„°í˜ì´ìŠ¤ ê³µìœ ë‹¤. ìƒì†ì„ í†µí•´ ìì‹ì€ ìì‹ ì˜ ì¸í„°í˜ì´ìŠ¤ì— ë¶€ëª¨ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ í¬í•¨í•˜ê²Œ ëœë‹¤. 

- ë¶€ëª¨ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ë©”ì‹œì§€ë¥¼ ìì‹ë„ **ê·¸ëŒ€ë¡œ ì´í•´**í•  ìˆ˜ ìˆë‹¤.
- ì™¸ë¶€ ê°ì²´ëŠ” ìì‹ í´ë˜ìŠ¤ë¥¼ ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ë™ì¼í•œ íƒ€ì…ìœ¼ë¡œ ê°„ì£¼í•  ìˆ˜ ìˆë‹¤.
- ì™¸ë¶€ ê°ì²´(Movie)ëŠ” "ì´ ë©”ì‹œì§€ë¥¼ ì´í•´í•  ìˆ˜ ìˆëŠëƒ"ë§Œ ì‹ ê²½ ì“°ë©´ ëœë‹¤.

```java
public class Movie {
	public Money calculateMovieFee(Screening screening) {
		return fee.minus(discountPolicy.calculateDiscountAmount(screening));
	}
}
```

- MovieëŠ” calculateDiscountAmount ë©”ì‹œì§€ì—ë§Œ ì˜ì¡´í•œë‹¤.
    - ë©”ì‹œì§€ë¥¼ ì´í•´í•  ìˆ˜ë§Œ ìˆë‹¤ë©´ ê·¸ ê°ì²´ê°€ ì–´ë–¤ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ëŠ” ìƒê´€í•˜ì§€ ì•ŠëŠ”ë‹¤.
    - discountPolicyì˜ êµ¬í˜„ì²´ë“¤ì€ ëª¨ë‘ calculateDiscountAmount ë©”ì‹œì§€ë¥¼ ì´í•´í•˜ë¯€ë¡œ í˜‘ë ¥í•  ìˆ˜ ìˆë‹¤.

**ìì‹ í´ë˜ìŠ¤ëŠ” ìƒì†ì„ í†µí•´ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë¬¼ë ¤ë°›ê¸° ë•Œë¬¸ì— ë¶€ëª¨ í´ë˜ìŠ¤ ëŒ€ì‹  ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.** 

**ğŸ‘‰ ì—…ìºìŠ¤íŒ… (Upcasting):** ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ëŒ€ì‹ í•˜ëŠ” ê²ƒ

### ë‹¤í˜•ì„±

- ë©”ì‹œì§€(message)
    - ê°ì²´ì—ê²Œ â€œì´ ì¼ì„ í•´ ë‹¬ë¼â€ë¼ê³  ìš”ì²­í•˜ëŠ”  ê²ƒ: `calculateDiscountAmount(screening)`
- ë©”ì„œë“œ(method)
    - ë©”ì‹œì§€ë¥¼ ì‹¤ì œë¡œ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œ ì¡°ê°

MovieëŠ” DiscountPolicyì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ë‹¤.

ì‹¤ì œ ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œëŠ” ì—°ê²°ëœ ê°ì²´ì˜ ì‹¤ì œ íƒ€ì…ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ğŸ‘‰ ë‹¤í˜•ì„±

**ë‹¤í˜•ì„±ì€ ì˜ì¡´ì„±ì˜ ì‹œì  ì°¨ì´ì—ì„œ ë‚˜ì˜¨ë‹¤.**

- ì»´íŒŒì¼ ì‹œì 
    - Movie â†’ DiscountPolicy(ì¶”ìƒ í´ë˜ìŠ¤)ì— ì˜ì¡´
    - ì»´íŒŒì¼ëŸ¬ëŠ” Movieê°€ ì‚¬ìš©í•˜ëŠ” ê±´ DiscountPolicy íƒ€ì…ì´ë¼ê³ ë§Œ ì•Œê³  ìˆë‹¤.
- ì‹¤í–‰ ì‹œì 
    - Movie â†’ AmountDiscountPolicy ë˜ëŠ” PercentDiscountPolicy ì¸ìŠ¤í„´ìŠ¤ì— ì‹¤ì œë¡œ ì˜ì¡´

**ë‹¤í˜•ì„±:  ë™ì¼í•œ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í–ˆì„ ë•Œ ê°ì²´ì˜ íƒ€ì…ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì‘ë‹µí•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥**

- ë‹¤í˜•ì„± í˜‘ë ¥ì— ì°¸ì—¬í•˜ë ¤ë©´ ê°ì²´ë“¤ì´ ê°™ì€ ë©”ì‹œì§€ë¥¼ ì´í•´í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
- ì¦‰, ì¸í„°í˜ì´ìŠ¤ê°€ ë™ì¼í•´ì•¼ í•œë‹¤.

**ë™ì  ë°”ì¸ë”© (Dynamic Binding), ì§€ì—° ë°”ì¸ë”©(lazy binding)** 

**â†”** ì´ˆê¸° ë°”ì¸ë”© (early binding), ì •ì  ë°”ì¸ë”©(static binding)

ë©”ì‹œì§€ëŠ” ê°™ì•„ë„ ë©”ì„œë“œ ì„ íƒì€ ì‹¤í–‰ ì‹œì  ê°ì²´ì˜ íƒ€ì…ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. 

`Movie`ê°€ `calculateDiscountAmount` ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´

- AmountDiscountPolicy ê°ì²´ë¼ë©´ â†’ AmountDiscountPolicyì˜ ë©”ì„œë“œ ì‹¤í–‰
- PercentDiscountPolicy ê°ì²´ë¼ë©´ â†’ PercentDiscountPolicyì˜ ë©”ì„œë“œ ì‹¤í–‰

**ì°¸ê³ : êµ¬í˜„ ìƒì†ê³¼ ì¸í„°í˜ì´ìŠ¤ ìƒì†**

**êµ¬í˜„ ìƒì† (Subclassing)**

- ë‹¨ìˆœíˆ ì½”ë“œ ì¬ì‚¬ìš© ëª©ì  (ë¶€ëª¨ì˜ ê¸°ëŠ¥ì„ ê°€ì ¸ì™€ì„œ ì“°ëŠ” ê²ƒ).
- ì¥ì : ë¹ ë¥¸ ê°œë°œ. ë‹¨ì : ë³€ê²½ì— ì·¨ì•½, ë¶€ëª¨ ë³€ê²½ ì‹œ ìì‹ë„ ì—°ì‡„ì ìœ¼ë¡œ ê¹¨ì§ˆ ìœ„í—˜.

**ì¸í„°í˜ì´ìŠ¤ ìƒì† (Subtyping)**

- ë‹¤í˜•ì  í˜‘ë ¥ì„ ìœ„í•´ ë™ì¼í•œ ë©”ì‹œì§€ë¥¼ ë³´ì¥í•˜ëŠ” ëª©ì .

ìƒì†ì˜ ì£¼ëœ ëª©ì ì€ ì½”ë“œ ì¬ì‚¬ìš©ì´ ì•„ë‹ˆë‹¤. êµ¬í˜„ì„ ì¬ì‚¬ìš©í•  ëª©ì ìœ¼ë¡œ ìƒì†ì„ ì‚¬ìš©í•˜ë©´ ë³€ê²½ì— ì·¨ì•½í•´ì§„ë‹¤. êµ¬í˜„ ìƒì†ë³´ë‹¤ëŠ” ì¸í„°í˜ì´ìŠ¤ ìƒì†ì„ ìš°ì„ í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. 

### ì¸í„°í˜ì´ìŠ¤ì™€ ë‹¤í˜•ì„±

|  | ì¶”ìƒ í´ë˜ìŠ¤ (DiscountPolicy) | ì¸í„°í˜ì´ìŠ¤ (DiscountCondition) |
| --- | --- | --- |
| êµ¬í˜„ ê³µìœ  | ê°€ëŠ¥ (#getDiscountAmount ë“±) | ì—†ìŒ |
| ë‹¤í˜•ì„± | ê°€ëŠ¥ | ê°€ëŠ¥ |
| ìš©ë„ | ê¸°ë³¸ ë™ì‘ ì œê³µ + ë‹¤í˜•ì„± | ìˆœìˆ˜ ë‹¤í˜•ì„± (ë©”ì‹œì§€ë§Œ ì •ì˜) |
| ìì‹ í´ë˜ìŠ¤ ì˜ˆ | AmountDiscountPolicy, PercentDiscountPolicy | SequenceCondition, PeriodCondition |

```mermaid
classDiagram
direction LR
		class DiscountPolicy{
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class DiscountCondition{
			+ isSatisfiedBy()
		}
		class SequenceCondition{
			+ isSatisfiedBy()
		}
		class PeriodCondition{
			+ isSatisfiedBy()
		}
		
    DiscountPolicy --> DiscountCondition : condition
    Discount Condition <|.. Sequence Condition
    Discount Condition <|.. Period Condition

    <<interface>> DiscountPolicy
    <<interface>> DiscountCondition
```

- DiscountPolicyëŠ” ê³µí†µ ì½”ë“œ(conditions ë¦¬ìŠ¤íŠ¸, calculateDiscountAmount êµ¬í˜„)ë¥¼ ê³µìœ í•  í•„ìš”ê°€ ìˆì–´ì„œ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ êµ¬í˜„
- DiscountConditionì€ ê³µìœ í•  êµ¬í˜„ì´ ì—†ê³  ë©”ì‹œì§€ë§Œ í•„ìš”í•´ì„œ ì¸í„°í˜ì´ìŠ¤ë¡œ êµ¬í˜„

## ì¶”ìƒí™”ì™€ ìœ ì—°ì„±

### ì¶”ìƒí™”ì˜ í˜

**ì¶”ìƒí™”**

- êµ¬ì²´ì ì¸ êµ¬í˜„ì´ ì•„ë‹ˆë¼ ê³µí†µëœ ì¸í„°í˜ì´ìŠ¤/ê°œë…ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒ
- ì˜ˆì‹œ:
    - `DiscountPolicy` = "í• ì¸ ì •ì±…"ì´ë¼ëŠ” ê°œë… (ê¸ˆì•¡/ë¹„ìœ¨ì€ êµ¬ì²´ì ì¸ êµ¬í˜„)
    - `DiscountCondition` = "í• ì¸ ì¡°ê±´"ì´ë¼ëŠ” ê°œë… (ìˆœë²ˆ/ê¸°ê°„ì€ êµ¬ì²´ì ì¸ êµ¬í˜„)

ì¶”ìƒí™”ëŠ” ë¬´ì—‡ì„ í• ì§€ì— ì§‘ì¤‘í•˜ê³ , ì–´ë–»ê²Œ í• ì§€ëŠ” í•˜ìœ„ í´ë˜ìŠ¤(êµ¬í˜„ì²´)ì—ê²Œ ë§¡ê¸´ë‹¤.

**ì¥ì **

```mermaid
classDiagram
direction LR
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class DiscountCondition{
			+ isSatisfiedBy()
		}
		
    Movie --> DiscountPolicy : discountPolicy
    DiscountPolicy --> DiscountCondition : conditions

    <<interface>> DiscountPolicy
    <<interface>> DiscountCondition

```

1. ìš”êµ¬ì‚¬í•­ì˜ ì •ì±…ì„ ë†’ì€ ìˆ˜ì¤€ì—ì„œ ì„œìˆ í•  ìˆ˜ ìˆë‹¤
    - ë„ë©”ì¸ì˜ í•µì‹¬ ê°œë…ì„ ê°„ë‹¨íˆ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
    - ì˜í™” ì˜ˆë§¤ ìš”ê¸ˆì€ ìµœëŒ€ í•˜ë‚˜ì˜ 'í• ì¸ ì •ì±…'ê³¼ ë‹¤ìˆ˜ì˜ 'í• ì¸ ì¡°ê±´'ì„ ì´ìš©í•´ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤
        - ì´ ë§ì€ **ê¸ˆì•¡ í• ì¸ ì •ì±… + ë‘ ê°œì˜ ìˆœë²ˆ ì¡°ê±´ + í•œ ê°œì˜ ê¸°ê°„ ì¡°ê±´** ê°™ì€ êµ¬ì²´ì ì¸ ê²½ìš°ë„ í¬í•¨í•œë‹¤.
    - í‘œí˜„ì˜ ìˆ˜ì¤€ì„ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.

1. ì¶”ìƒí™”ë¥¼ ì´ìš©í•˜ë©´ ì„¤ê³„ê°€ ì¢€ ë” ìœ ì—°í•´ì§„ë‹¤
    - ìƒˆë¡œìš´ êµ¬í˜„ í´ë˜ìŠ¤ë“¤ì€ ì¶”ìƒí™”ë¥¼ ì´ìš©í•´ì„œ ì •ì˜í•œ ìƒìœ„ì˜ í˜‘ë ¥ íë¦„ì„ ê·¸ëŒ€ë¡œ ë”°ë¥´ê²Œ ëœë‹¤.
        - ê¸°ì¡´ êµ¬ì¡°(`Movie â†’ DiscountPolicy â†’ DiscountCondition`)ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€.
    - ê¸°ì¡´ êµ¬ì¡°ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³ ë„ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì‰½ê²Œ ì¶”ê°€í•˜ê³  í™•ì¥í•  ìˆ˜ ìˆë‹¤.
        - ìƒˆë¡œìš´ í• ì¸ ì •ì±…(`NewDiscountPolicy`)ì´ë‚˜ ìƒˆë¡œìš´ ì¡°ê±´(`NewCondition`)ì„ ì¶”ê°€í•  ë•Œë„ ê¸°ì¡´ì˜ `DiscountPolicy` / `DiscountCondition` íë¦„ì„ ê·¸ëŒ€ë¡œ ë”°ë¥´ë©´ ëœë‹¤.

### ìœ ì—°í•œ ì„¤ê³„

**ë¬¸ì œ: 'ìŠ¤íƒ€ì›Œì¦ˆ'ëŠ” í• ì¸ ì •ì±…ì´ ì—†ë‹¤.**

```java
public class Movie {
	public Money calculateMovieFee(Screening screening) {
		if (discountPolicy == null) {
			return fee:
		}
		
		return fee.minus(discountPolicy.calculateDiscountAmount(screening));
	}
}
```

- ê¸°ì¡´ ì„¤ê³„ë¡œëŠ” ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•´ì„œ ì˜ˆì™¸ ìƒí™©ì„ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.
- í• ì¸ ê¸ˆì•¡ì„ ê³„ì‚°í•˜ëŠ” ì±…ì„ì´ `DiscountPolicy`ì˜ í•˜ìœ„ í´ë˜ìŠ¤ì— ìˆì—ˆì§€ë§Œ ì´ ê²½ìš°, `Movie` ìª½ìœ¼ë¡œ ì˜®ê²¨ê°€ë©´ì„œ ì¼ê´€ì„±ì´ ì—†ì–´ì§„ë‹¤.

**í•´ê²°: í• ì¸ ìš”ê¸ˆì„ ê³„ì‚°í•  ì±…ì„ì„ DiscountPolicy ê³„ì¸µì— ìœ ì§€ì‹œí‚¨ë‹¤.**

```java
public class NoneDiscountPolicy extends DiscountPolicy {
	@Override
	protected Money getDiscountAmount(Screening screening) {
		return Money.ZERO;
	}
}

Movie starNars = new Movie("ìŠ¤íƒ€ì›Œì¦ˆ",
	Duration.ofMinutes(210),
	Money.wons(10000),
	new NoneDiscountPolicy());
```

- `Movie`ì˜ ì¡°ê±´ë¬¸ ì œê±° ê°€ëŠ¥.
- ì˜ˆì™¸ ì¼€ì´ìŠ¤ë„ ì¼ê´€ëœ í˜‘ë ¥ ë°©ì‹ ìœ ì§€.

**ì¤‘ìš”í•œ í¬ì¸íŠ¸**

- ê¸°ì¡´ ì½”ë“œ(Movie, DiscountPolicy) ìˆ˜ì • ì—†ìŒ
- ìƒˆë¡œìš´ í´ë˜ìŠ¤(NoneDiscountPolicy) ì¶”ê°€ë§Œìœ¼ë¡œ ê¸°ëŠ¥ í™•ì¥ ê°€ëŠ¥
- í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆê³ , ìˆ˜ì •ì—ëŠ” ë‹«í˜€ ìˆëŠ” êµ¬ì¡° â†’ `OCP(ê°œë°©-íì‡„ ì›ì¹™)` ì‹¤í˜„

**ì»¨í…ìŠ¤íŠ¸ ë…ë¦½ì„±(Context Independency)**

- `Movie`ëŠ” íŠ¹ì •í•œ í• ì¸ ì •ì±…ì— ë¬¶ì´ì§€ ì•ŠìŒ â†’ ì–´ë–¤ `DiscountPolicy` í•˜ìœ„ í´ë˜ìŠ¤ì™€ë„ í˜‘ë ¥ ê°€ëŠ¥
- `DiscountPolicy` ì—­ì‹œ íŠ¹ì • ì¡°ê±´ì— ë¬¶ì´ì§€ ì•ŠìŒ â†’ ì–´ë–¤ `DiscountCondition` í•˜ìœ„ í´ë˜ìŠ¤ì™€ë„ í˜‘ë ¥ ê°€ëŠ¥
- ìƒˆë¡œìš´ ì •ì±…/ì¡°ê±´ ì¶”ê°€ ì‹œ ê¸°ì¡´ íë¦„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ ê°€ëŠ¥

```mermaid
classDiagram
direction LR
		
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class None DiscountPolicy{
			# getDiscountAmount()
		}
		class Amount DiscountPolicy{
			# getDiscountAmount()
		}
		class Percent DiscountPolicy{
			# getDiscountAmount()
		}
		class DiscountCondition{
			+ isSatisfiedBy()
		}
		class SequenceCondition{
			+ isSatisfiedBy()
		}
		class PeriodCondition{
			+ isSatisfiedBy()
		}
		
    Movie --> DiscountPolicy : discountPolicy
    DiscountPolicy --> DiscountCondition : conditions

		None DiscountPolicy --|> DiscountPolicy
		Amount DiscountPolicy --|> DiscountPolicy
    Percent DiscountPolicy --|> DiscountPolicy
    
    Discount Condition <|.. Sequence Condition
    Discount Condition <|.. Period Condition

    <<interface>> DiscountPolicy
    <<interface>> DiscountCondition

```

ìœ ì—°ì„±ì´ í•„ìš”í•œ ê³³ì— ì¶”ìƒí™”ë¥¼ ì‚¬ìš©í•˜ì!

### ì¶”ìƒ í´ë˜ìŠ¤ì™€ ì¸í„°í˜ì´ìŠ¤ íŠ¸ë ˆì´ë“œì˜¤í”„

**ë¬¸ì œ: `NoneDiscountPolicy`ëŠ” `getDiscountAmount()`ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì„ ê²ƒì´ë¼ëŠ” ì„¸ë¶€ì‚¬í•­ì— ì˜ì¡´í•œë‹¤. ë¶ˆí•„ìš”í•œ ê°œë…ì  ê²°í•©ì´ë‹¤.** 

**í•´ê²°: ì¸í„°í˜ì´ìŠ¤ ë„ì…**

1. DiscountPolicy â†’ ì¸í„°í˜ì´ìŠ¤ë¡œ ë³€ê²½
    
    ```java
    public interface DiscountPolicy {
    	Money calculateDiscountAmount(Screening screening);
    }
    ```
    
2. ê¸°ì¡´ì˜ ì¶”ìƒ í´ë˜ìŠ¤ëŠ” `DefaultDiscountPolicy`ë¡œ ì´ë¦„ì„ ë°”ê¾¸ê³ , ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ë„ë¡ ë³€ê²½
    
    ```java
    public abstract class DefaultDiscountPolicy implements DiscountPolicy {
    	...
    }
    ```
    
3. `NoneDiscountPolicy`ëŠ” `DiscountPolicy` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„
    
    ```java
    public class NoneDiscountPolicy implements DiscountPolicy {
    	@0verride
    	public Money calculateDiscountAmount(Screening screening) {
    		return Money.ZERO;
    	}
    }
    ```
    

ì´ë ‡ê²Œ í•˜ë©´ **ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë‚´ë¶€ ë™ì‘ì— ì˜ì¡´í•˜ì§€ ì•Šê³ **, ì˜¤ì§ ì¸í„°í˜ì´ìŠ¤ë§Œ êµ¬í˜„í•˜ë©´ ëœë‹¤.

ê²°í•©ë„ â†“, ëª…í™•ì„± â†‘.

```mermaid
classDiagram
direction LR
		
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class None DiscountPolicy {
			# getDiscountAmount()
		}
		class DefaultDiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class Amount DiscountPolicy{
			# getDiscountAmount()
		}
		class Percent DiscountPolicy{
			# getDiscountAmount()
		}
		class DiscountCondition{
			+ isSatisfiedBy()
		}
		class SequenceCondition{
			+ isSatisfiedBy()
		}
		class PeriodCondition{
			+ isSatisfiedBy()
		}
		
    Movie --> DiscountPolicy : discountPolicy
    DiscountPolicy --> DiscountCondition : conditions

		None DiscountPolicy ..|> DiscountPolicy
		DefaultDiscountPolicy  ..|> DiscountPolicy
		Amount DiscountPolicy --|> DefaultDiscountPolicy  
    Percent DiscountPolicy --|> DefaultDiscountPolicy  
    
    Discount Condition <|.. Sequence Condition
    Discount Condition <|.. Period Condition
    
    <<interface>> DiscountPolicy
    <<interface>> DiscountCondition

```

- **ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš© ì¥ì **
    - ê°œë…ì ìœ¼ë¡œ ë” ê¹”ë”í•¨
        - `NoneDiscountPolicy`ê°€ "0ì›ì„ ë°˜í™˜í•˜ëŠ” ì •ì±…"ì„ì„ ì§ê´€ì ìœ¼ë¡œ ë“œëŸ¬ëƒ„
    - ë¶ˆí•„ìš”í•œ ë‚´ë¶€ ì˜ì¡´ ì œê±°
    - í™•ì¥ì„± â†‘
- **ì¶”ìƒ í´ë˜ìŠ¤ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì¥ì **
    - êµ¬ì¡° ë‹¨ìˆœ
        - ì¸í„°í˜ì´ìŠ¤ê¹Œì§€ ì¶”ê°€í•˜ì§€ ì•Šì•„ë„ ë¨.
    - êµ¬í˜„ëŸ‰ â†“

ì´ìƒì ì¸ ì„¤ê³„ëŠ” **ì¸í„°í˜ì´ìŠ¤ ë°©ì‹ì´ë‹¤.** í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” NoneDiscountPolicyë¥¼ ìœ„í•´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ” ê²Œ ê³¼ì—° í•„ìš”í•œì§€ ê³ ë¯¼ í•  ìˆ˜ ìˆë‹¤. 

ì¤‘ìš”í•œ ê²ƒì€ êµ¬í˜„ê³¼ ê´€ë ¨ëœ ëª¨ë“  ê²ƒë“¤ì´ íŠ¸ë ˆì´ë“œì˜¤í”„ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. **íŠ¸ë ˆì´ë“œì˜¤í”„ëŠ” í•­ìƒ ì¡´ì¬**í•˜ë©°, í•©ë‹¹í•œ ì´ìœ  ì—†ì´ ë¬´ì¡°ê±´ ì¸í„°í˜ì´ìŠ¤/ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì€ í”¼í•´ì•¼ í•œë‹¤. 

### ì½”ë“œ ì¬ì‚¬ìš©

1. **ìƒì† (Inheritance)**
    - ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë°©ë²•
    - ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•´ì„œ ìì‹ í´ë˜ìŠ¤ì—ì„œ ê¸°ëŠ¥ì„ ì¬ì‚¬ìš©
        - `AmountDiscountMovie`, `PercentDiscountMovie`ê°€ `Movie`ë¥¼ ìƒì†ë°›ëŠ” ê²½ìš°. ê¸°ì¡´ ë°©ë²•ê³¼ ê¸°ëŠ¥ì ì´ ê´€ì ì—ì„œ ë™ì¼í•˜ë‹¤.
            
            ```mermaid
            classDiagram
            direction BT
            		
            		class Movie{
            			+ calculateMovieFee(screening)
            			# getDiscountAmount(screening)
            		}
            		class Amount DiscountMovie{
            			# getDiscountAmount(screening)
            		}
            		class Percent DiscountMovie{
            			# getDiscountAmount(screening
            		}
            			
            		Amount DiscountMovie --|> Movie
                Percent DiscountMovie --|> Movie
            
            ```
            
2. **í•©ì„± (Composition)**
    - ë‹¤ë¥¸ ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ í¬í•¨í•´ì„œ ê·¸ ê¸°ëŠ¥ì„ ì¬ì‚¬ìš©
        - `Movie`ê°€ `DiscountPolicy`ë¥¼ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ê°€ì§€ê³  í˜‘ë ¥í•˜ëŠ” ê²½ìš°.

**ë§ì€ ì‚¬ëŒë“¤ì´ ìƒì† ëŒ€ì‹  í•©ì„±ì„ ì„ í˜¸í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œâ“**

### ìƒì†

**ìƒì†ì˜ ë‹¨ì **

- ìº¡ìŠí™” ìœ„ë°˜
    - ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë‚´ë¶€ êµ¬í˜„ì„ ì•Œì•„ì•¼ ë™ì‘ ê°€ëŠ¥í•˜ë‹¤.
    - ì˜ˆ: `AmountDiscountMovie`ëŠ” `Movie.calculateMovieFee()` ë‚´ë¶€ì—ì„œ `getDiscountAmount()`ë¥¼ í˜¸ì¶œí•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ìˆì–´ì•¼ë§Œ ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•œë‹¤.
        - ë¶€ëª¨ ë³€ê²½ ì‹œ ìì‹ë„ ê°™ì´ ê¹¨ì§ˆ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.  (ê°•í•œ ê²°í•©).
- ìœ ì—°í•˜ì§€ ì•ŠìŒ
    - ìƒì†ì€ ì»´íŒŒì¼ ì‹œì ì— ê´€ê³„ê°€ ê²°ì •ëœë‹¤.
    - ì‹¤í–‰ ì¤‘ì— "ê¸ˆì•¡ í• ì¸ ì •ì±…"ì„ "ë¹„ìœ¨ í• ì¸ ì •ì±…"ìœ¼ë¡œ ë°”ê¾¸ë ¤ë©´?
        - `AmountDiscountMovie` ê°ì²´ë¥¼ `PercentDiscountMovie`ë¡œ êµì²´í•´ì•¼ í•¨.
        - ì´ë¯¸ ìƒì„±ëœ ê°ì²´ì˜ í´ë˜ìŠ¤ë¥¼ ë°”ê¾¸ë ¤ë©´ ìƒˆ ê°ì²´ë¥¼ ë§Œë“¤ê³  ìƒíƒœë¥¼ ë³µì‚¬í•´ì•¼ í•œë‹¤.
    - ê²°ê³¼: ìœ ì§€ë³´ìˆ˜/í™•ì¥ì„±ì´ ë–¨ì–´ì§.

ë°˜ë©´ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ì‹¤í–‰ ì‹œì ì— í• ì¸ ì •ì±…ì„ ê°„ë‹¨í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆ
ë‹¤. (ê¸°ì¡´ ë°©ë²•)

**í•©ì„±**

- Movieì— DiscountPolicyë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” changeDiscountPolicy ë©”ì„œë“œë¥¼ ì¶”ê°€í•œë‹¤.

```java
public class Movie {
	private DiscountPolicy discountPolicy;
	
	public void changeDiscountPolicy(DiscountPolicy discountPolicy) {
		this.discountPolicy= discountPolicy:
	}
}
```

- ì‹¤í–‰ ì¤‘ì—ë„ ì •ì±…ì„ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

```java
Movie avatar = new Movie("ì•„ë°”íƒ€",
	Duration.ofMinutes(120),
	Money.wons(10000),
	new AmountDiscountPolicy(Money.wons(800), ... ));

avatar.changeDiscountPolicy(new PercentDiscountPolicy(0.1, ... ));
```

- ê°ì²´ ê°„ ê²°í•©ì´ ëŠìŠ¨í•˜ê³ , ë³€ê²½/í™•ì¥ì´ ì‰½ë‹¤.
- ì„¤ê³„ì˜ ìœ ì—°ì„± â†‘, ìº¡ìŠí™” ë³´ì¥

Movieê°€ DiscountPolicyë¥¼ í¬í•¨í•˜ëŠ” ì´ ë°©ë²• ì—­ì‹œ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ë°©ë²•!

### í•©ì„±

**í•©ì„±**

`Movie`ëŠ” ìš”ê¸ˆì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ `DiscountPolicy`ë¥¼ í¬í•¨í•œë‹¤. (ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì°¸ì¡°) `Movie`ëŠ” `DiscountPolicy`ì˜ ë‚´ë¶€ êµ¬í˜„ì„ ì•Œ í•„ìš” ì—†ë‹¤. `calculateDiscountAmount()`ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œ ì•Œë©´ ëœë‹¤. ì´ë ‡ê²Œ ì¸í„°í˜ì´ìŠ¤ì— ì •ì˜ëœ ë©”ì‹œì§€ë¥¼ í†µí•´ì„œë§Œ í˜‘ë ¥í•˜ëŠ” ë°©ì‹ì„ í•©ì„±ì´ë¼ í•œë‹¤.

ìƒì†ì€ ë¶€ëª¨ì™€ ìì‹ì´ ì»´íŒŒì¼ ì‹œì ì— í•˜ë‚˜ì˜ ë‹¨ìœ„ë¡œ ê°•í•˜ê²Œ ê²°í•©ë˜ëŠ”ë° í•©ì„±ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì•½í•˜ê²Œ ê²°í•©ëœë‹¤. 

**í•©ì„±ì´ ìƒì†ë³´ë‹¤ ë‚˜ì€ ì´ìœ **

1. ìº¡ìŠí™” ë³´ì¥
    - í•©ì„±ì€ ë‚´ë¶€ êµ¬í˜„ì„ ìˆ¨ê¸°ê³ , ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
    - ë¶€ëª¨ í´ë˜ìŠ¤ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì•Œì•„ì•¼ í•˜ëŠ” ìƒì†ì˜ ìº¡ìŠí™” ìœ„ë°˜ ë¬¸ì œë¥¼ í”¼í•  ìˆ˜ ìˆìŒ.
2. ìœ ì—°ì„±
    - ì˜ì¡´í•˜ëŠ” ê°ì²´(`DiscountPolicy`)ë¥¼ ì‹¤í–‰ ì‹œì ì— êµì²´ ê°€ëŠ¥.
    - ì„¤ê³„ê°€ í›¨ì”¬ ìœ ì—°í•´ì§€ê³  ì¬ì‚¬ìš©ì„±ì´ ë†’ì•„ì§.
    - ë°˜ë©´, ìƒì†ì€ ì»´íŒŒì¼ ì‹œì ì— ê²°í•©ë˜ì–´ ë³€ê²½ ë¶ˆê°€ëŠ¥.

**ìƒì†ë„ í•„ìš”í•˜ë‹¤.**

ëŒ€ë¶€ë¶„ì˜ ì„¤ê³„ì—ì„œëŠ” ìƒì†ê³¼ í•©ì„±ì„ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

- ì˜ˆ:
    - `Movie` â†” `DiscountPolicy`ëŠ” **í•©ì„± ê´€ê³„**.
    - `DiscountPolicy` â†” `AmountDiscountPolicy`, `PercentDiscountPolicy`ëŠ” **ìƒì† ê´€ê³„**.
- ì¦‰, **í•©ì„±ê³¼ ìƒì†ì€ í•¨ê»˜ ì¡°í•©**í•´ì„œ ì“°ì´ëŠ” ê²½ìš°ê°€ ë§ìŒ.
    - ì½”ë“œ ì¬ì‚¬ìš©ì€ í•©ì„±ì„ ì„ í˜¸.
    - ë‹¤í˜•ì  í˜‘ë ¥ì€ ìƒì†ì´ í•„ìš”.

```mermaid
classDiagram
direction LR
		
		class Movie{
			+ calculateMovieFee()
		}
		class DiscountPolicy {
			+ calculateDiscountAmount()
			# getDiscountAmount()
		}
		class Amount DiscountPolicy{
			# getDiscountAmount()
		}
		class Percent DiscountPolicy{
			# getDiscountAmount()
		}

		
    Movie --> DiscountPolicy : discountPolicy

		Amount DiscountPolicy --|> DiscountPolicy
    Percent DiscountPolicy --|> DiscountPolicy

    <<interface>> DiscountPolicy

```

- `Movie` â†” `DiscountPolicy`ëŠ” í•©ì„± ê´€ê³„
- `DiscountPolicy` â†” `AmountDiscountPolicy`, `PercentDiscountPolicy`ëŠ” ìƒì† ê´€ê³„

ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” ìƒì†ë³´ë‹¤ í•©ì„±ì„ ì„ í˜¸í•˜ëŠ” ê²ƒì´ ì˜³ì§€ë§Œ ë‹¤í˜•ì„±ì„ ìœ„í•´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” ìƒì†ê³¼ í•©ì„±ì„ ì¡°í•©í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. 

- ì½”ë“œ ì¬ì‚¬ìš©ì€ í•©ì„±ì„ ì„ í˜¸
- ë‹¤í˜•ì  í˜‘ë ¥ì€ ìƒì†ì´ í•„ìš”

**ê°ì²´ì§€í–¥ì˜ ë³¸ì§ˆ**

ë§ì€ ì‚¬ëŒë“¤ì´ ê°ì²´ì§€í–¥ì„ í´ë˜ìŠ¤ ì‘ì„± + ìƒì†ì„ í†µí•œ ì½”ë“œ ì¬ì‚¬ìš© ì •ë„ë¡œ ìƒê°í•œë‹¤. â†’ í‹€ë¦¼

ê°ì²´ì§€í–¥ì˜ ë³¸ì§ˆì€ ê°ì²´ë“¤ ê°„ì˜ í˜‘ë ¥ê³¼ ìƒí˜¸ì‘ìš©ì´ë‹¤.

1. í˜‘ë ¥: ì ì ˆí•œ í˜‘ë ¥ì„ ì‹ë³„í•˜ê³  
2. ì—­í• : í˜‘ë ¥ì— í•„ìš”í•œ ì—­í• ì„ ì •ì˜
3. ì±…ì„: ì ì ˆí•œ ê°ì²´ì—ê²Œ ì ì ˆí•œ ì±…ì„ì„ í• ë‹¹